/**************************************************\
|* Script Author: Djordje Jocic                   *|
|* Script Year: 2015                              *|
|* Script Version: 1.0.2                          *|
|* Script License: MIT License (MIT)              *|
|* ============================================== *|
|* Official Website: http://www.djordjejocic.com/ *|
|* ============================================== *|
|* Permission is hereby granted, free of charge,  *|
|* to any person obtaining a copy of this         *|
|* software and associated documentation files    *|
|* (the "Software"), to deal in the Software      *|
|* without restriction, including without         *|
|* limitation the rights to use, copy, modify,    *|
|* merge, publish, distribute, sublicense, and/or *|
|* sell copies of the Software, and to permit     *|
|* persons to whom the Software is furnished to   *|
|* do so, subject to the following conditions:    *|
|* ---------------------------------------------- *|
|* The above copyright notice and this permission *|
|* notice shall be included in all copies or      *|
|* substantial portions of the Software.          *|
|* ---------------------------------------------- *|
|* THE SOFTWARE IS PROVIDED "AS IS", WITHOUT      *|
|* WARRANTY OF ANY KIND, EXPRESS OR IMPLIED,      *|
|* INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF *|
|* MERCHANTABILITY, FITNESS FOR A PARTICULAR      *|
|* PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL *|
|* THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR *|
|* ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER *|
|* IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,   *|
|* RISING FROM, OUT OF OR IN CONNECTION WITH THE  *|
|* SOFTWARE OR THE USE OR OTHER DEALINGS IN THE   *|
|* SOFTWARE.                                      *|
\**************************************************/

function ParallaxRenderer(){this.render=function(a,l,r){if(r.parallaxInit){var e=this.calculateParallaxRatio(a,r.start,r.end);a-=l.offset().top;var t=-Math.floor(e*r.offset),n=this.parsePosition(l.css("background-position"));n.left+="px",n.top=t+"px",l.css("background-position",n.left+" "+n.top)}},this.parseLocation=function(a){return a.trim().replace(/^((url\()+(`|'|"))/,"").replace(/((`|'|")+(\)))$/,"")},this.parsePosition=function(a){var l={left:0,top:0};return a=a.replace(/[^0-9\s]/g,"").trim().split(" ",2),l.left=a[0],l.top=a[1],l},this.clamp=function(a,l,r){return l>a?l:a>r?r:a},this.calculateOffset=function(a,l){if(l.height>=a.height)return 0;var r=l.width()/a.width,e=Math.floor(a.height*r);return e-l.height()},this.calculateParallaxRatio=function(a,l,r){return l=0>l?0:l,a-=l,r-=l,a/r}}!function(a){a.fn.parallaxCore={scrollDefault:[],scrollManual:[],countDefault:0,countManual:0,refreshTimeout:null,renderer:new ParallaxRenderer},a.fn.parallax=function(l){var r=a(this),e=a(this).data("parallaxSettings");if("undefined"==typeof e){var t=new Image,n=a("<div />",{"class":"parallax-preloader",style:"display: none;"});"undefined"==typeof l&&(l={image:null,height:null,billboard:!0,scroll:"default"}),l.parallaxInit=!0,t.onload=function(){n.remove(),l.offset=a.fn.parallaxCore.renderer.calculateOffset(t,r),r.data("parallaxSettings",l),"default"===l.scroll?(a.fn.parallaxCore.scrollDefault.push(r),a.fn.parallaxCore.countDefault++):"manual"===l.scroll&&(a.fn.parallaxCore.scrollManual.push(r),a.fn.parallaxCore.countManual++)},n.appendTo(r),setTimeout(function(){n.show()},1e3),null==l.image?t.src=a.fn.parallaxCore.renderer.parseLocation(r.css("background-image")):(r.css({"background-image":"url("+l.image+")","background-size":"100% auto"}),t.src=l.image),null==l.height?l.height=r.height():r.height(l.height),l.start=r.offset().top-a(window).height(),l.end=r.height()+r.offset().top}},a.fn.parallaxScroll=function(l){var r=a(this),e=a(this).data("parallaxSettings");a.isEmptyObject(e)||l>=e.start&&l<=e.end&&a.fn.parallaxCore.renderer.render(l,r,e)},a(document).scroll(function(){for(var l=a(this).scrollTop(),r=null,e=null,t=0;t<a.fn.parallaxCore.countDefault;t++)r=a.fn.parallaxCore.scrollDefault[t],e=a.fn.parallaxCore.scrollDefault[t].data("parallaxSettings"),l>=e.start&&l<=e.end&&a.fn.parallaxCore.renderer.render(l,r,e)}),a(window).resize(function(){null==a.fn.parallaxCore.refreshTimeout&&(a.fn.parallaxCore.refreshTimeout=setTimeout(function(){for(var l=null,r=null,e=0;e<a.fn.parallaxCore.countDefault;e++)l=a.fn.parallaxCore.scrollDefault[e],r=a.fn.parallaxCore.scrollDefault[e].data("parallaxSettings"),r.start=l.offset().top-a(window).height(),a.fn.parallaxCore.scrollDefault[e].data("parallaxSettings",r);for(var e=0;e<a.fn.parallaxCore.countManual;e++)l=a.fn.parallaxCore.scrollManual[e],r=a.fn.parallaxCore.scrollManual[e].data("parallaxSettings"),r.start=l.offset().top-a(window).height(),a.fn.parallaxCore.scrollManual[e].data("parallaxSettings",r);a.fn.parallaxCore.refreshTimeout=null},1e3))})}(jQuery);
